[Unit]
Description=Envoy Proxy Server
Conflicts=kong.service

[Service]
Type=simple
ExecStart=/usr/bin/bash -c '/opt/envoy/envoy --config-path /opt/envoy/envoy.yml'
User=envoy

Slice=envoy.slice
Restart=always
RestartSec=3
LimitNOFILE=100000

# The envoy user is unpriviledged and thus not permited to bind on ports < 1024
# Via systemd we grant the process a set of priviledges to bind to 80/443
# See http://archive.vn/36zJU
AmbientCapabilities=CAP_NET_BIND_SERVICE

[Install]
WantedBy=multi-user.target
